const ws=new WebSocket(`${"https:"===window.location.protocol?"wss":"ws"}://${window.location.host}/ws`),form=document.getElementById("optionsForm"),resultDiv=document.getElementById("result"),samplePaths=document.getElementById("samplePaths"),calculator=document.querySelector(".calculator"),results=document.querySelector(".results");function renderTable(e){samplePaths.innerHTML="";const t=Object.keys(e[0]),a=document.createElement("tr");t.forEach(e=>{var t=document.createElement("th");t.textContent=e,a.appendChild(t)}),samplePaths.appendChild(a),e.forEach(a=>{const n=document.createElement("tr");t.forEach(e=>{var t=document.createElement("td");t.textContent=a[e],n.appendChild(t)}),samplePaths.appendChild(n)});var n=document.getElementById("downloadButton");n.classList.remove("hidden"),n.addEventListener("click",()=>downloadCSV(e))}function downloadCSV(e){const a=Object.keys(e[0]);var e=e.map(t=>a.map(e=>t[e]).join(",")),e=[a.join(","),...e].join("\n"),e=new Blob([e],{type:"text/csv"}),e=URL.createObjectURL(e),t=document.createElement("a");t.href=e,t.download="sample_paths.csv",t.click(),URL.revokeObjectURL(e)}document.getElementById("calculateButton").addEventListener("click",()=>{var e=new FormData(form),e=Object.fromEntries(e.entries());e.S0=parseFloat(e.S0),e.K=parseFloat(e.K),e.rfr=parseFloat(e.rfr),e.sigma=parseFloat(e.sigma),e.T=parseFloat(e.T),e.q1=parseFloat(e.q1),ws.send(JSON.stringify(e)),calculator.classList.add("active"),results.classList.add("active")}),ws.onmessage=e=>{e=JSON.parse(e.data);"error"===e.type?alert(`Error: ${e.message}
    Details: `+JSON.stringify(e.details)):"result"===e.type&&(resultDiv.textContent=e.message,renderTable(e.data))};